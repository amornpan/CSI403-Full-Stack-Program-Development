"""
PDF to Video with Thai AI Voice - Lab 01: Git + Python Fundamentals
====================================================================
"""

import asyncio
import edge_tts
from pathlib import Path
from pdf2image import convert_from_path
from moviepy.editor import ImageClip, AudioFileClip, concatenate_videoclips

# ============================================
# CONFIGURATION
# ============================================
PDF_FILE = "lab01.pdf"
OUTPUT_VIDEO = "lab01-git-python.mp4"
VOICE = "th-TH-NiwatNeural"
RATE = "-15%"
DPI = 200

# ============================================
# SCRIPTS - Lab 01: Git + Python Fundamentals
# ============================================
SCRIPTS = [
    # Slide 1 - Title
    """‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô...
    ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà ‡πÅ‡∏•‡πá‡∏ö‡∏ó‡∏µ‡πà 1... 
    ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡∏Å‡∏¥‡∏ï ‡πÅ‡∏•‡∏∞ ‡πÑ‡∏û‡∏ò‡∏≠‡∏ô ‡∏ü‡∏±‡∏ô‡∏î‡∏≤‡πÄ‡∏°‡∏ô‡∏ó‡∏±‡∏•‡∏™‡πå...
    ‡πÅ‡∏•‡πá‡∏ö‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô 3.75 ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ñ‡∏£‡∏±‡∏ö...
    ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏Å‡∏¥‡∏ï ‡πÅ‡∏•‡∏∞‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ‡πÑ‡∏û‡∏ò‡∏≠‡∏ô ‡πÑ‡∏õ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô""",
    
    # Slide 2 - Objectives
    """‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Ç‡∏≠‡∏á‡πÅ‡∏•‡πá‡∏ö‡∏ô‡∏µ‡πâ‡∏°‡∏µ 3 ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏£‡∏±‡∏ö...
    ‡∏Ç‡πâ‡∏≠‡πÅ‡∏£‡∏Å... ‡∏ü‡∏≠‡∏£‡πå‡∏Ñ ‡πÅ‡∏•‡∏∞ ‡πÇ‡∏Ñ‡∏•‡∏ô ‡∏£‡∏µ‡πÇ‡∏û‡∏ã‡∏¥‡∏ó‡∏≠‡∏£‡∏µ‡πà Generic-RAG...
    ‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏á... ‡∏ù‡∏∂‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏Å‡∏¥‡∏ï ‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏Ñ‡πÇ‡∏ü‡∏•‡∏ß‡πå...
    ‡∏Ç‡πâ‡∏≠‡∏™‡∏≤‡∏°... ‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ‡πÑ‡∏û‡∏ò‡∏≠‡∏ô...
    ‡∏£‡∏µ‡πÇ‡∏û‡∏ã‡∏¥‡∏ó‡∏≠‡∏£‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Ñ‡∏∑‡∏≠... 
    github.com/amornpan/Generic-RAG ‡∏Ñ‡∏£‡∏±‡∏ö""",
    
    # Slide 3 - Task 1: Fork Repository
    """‡∏°‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≤‡∏™‡∏Ñ‡πå‡πÅ‡∏£‡∏Å‡∏Å‡∏±‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö... ‡∏Å‡∏≤‡∏£‡∏ü‡∏≠‡∏£‡πå‡∏Ñ‡∏£‡∏µ‡πÇ‡∏û‡∏ã‡∏¥‡∏ó‡∏≠‡∏£‡∏µ‡πà...
    ‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà github.com/amornpan/Generic-RAG...
    ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° Fork ‡∏ó‡∏µ‡πà‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô...
    ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡∏°‡∏µ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏£‡∏µ‡πÇ‡∏û‡∏ã‡∏¥‡∏ó‡∏≠‡∏£‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö...
    ‡∏ó‡∏¥‡∏õ... ‡∏Å‡∏≤‡∏£‡∏ü‡∏≠‡∏£‡πå‡∏Ñ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ...
    ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Å‡∏±‡∏ö‡∏£‡∏µ‡πÇ‡∏û‡∏ã‡∏¥‡∏ó‡∏≠‡∏£‡∏µ‡πà‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö""",
    
    # Slide 4 - Task 2: Clone to Local
    """‡∏ó‡∏≤‡∏™‡∏Ñ‡πå‡∏ó‡∏µ‡πà 2... ‡πÇ‡∏Ñ‡∏•‡∏ô‡∏°‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ö...
    ‡πÄ‡∏õ‡∏¥‡∏î ‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏°‡∏¥‡∏ô‡∏±‡∏• ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Ñ‡∏≠‡∏°‡∏°‡∏≤‡∏ô‡∏î‡πå‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡πå...
    ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á git clone ‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢ URL ‡∏Ç‡∏≠‡∏á‡∏£‡∏µ‡πÇ‡∏û‡∏ã‡∏¥‡∏ó‡∏≠‡∏£‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ü‡∏≠‡∏£‡πå‡∏Ñ‡∏°‡∏≤...
    ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô YOUR_USERNAME ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠ ‡∏Å‡∏¥‡∏ï‡∏Æ‡∏±‡∏ö ‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö...
    ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÇ‡∏Ñ‡∏•‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à ‡πÉ‡∏´‡πâ cd ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå Generic-RAG""",
    
    # Slide 5 - Task 3: Setup Environment
    """‡∏ó‡∏≤‡∏™‡∏Ñ‡πå‡∏ó‡∏µ‡πà 3... ‡πÄ‡∏ã‡πá‡∏ï‡∏≠‡∏±‡∏õ ‡πÄ‡∏≠‡∏ô‡πÑ‡∏ß‡∏£‡∏≠‡∏ô‡πÄ‡∏°‡∏ô‡∏ï‡πå‡∏Ñ‡∏£‡∏±‡∏ö...
    ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ ‡∏Ñ‡∏≠‡∏ô‡∏î‡∏≤ ‡∏™‡∏£‡πâ‡∏≤‡∏á ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏ß‡∏• ‡πÄ‡∏≠‡∏ô‡πÑ‡∏ß‡∏£‡∏≠‡∏ô‡πÄ‡∏°‡∏ô‡∏ï‡πå...
    ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á conda create -n rag_env python=3.10 -y...
    ‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡∏à‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à...
    ‡πÅ‡∏•‡πâ‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå conda activate rag_env ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô...
    ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢ pip install -r requirements.txt...
    ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡πà ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ñ‡∏£‡∏±‡∏ö""",
    
    # Slide 6 - Task 4: Create Feature Branch
    """‡∏ó‡∏≤‡∏™‡∏Ñ‡πå‡∏ó‡∏µ‡πà 4... ‡∏™‡∏£‡πâ‡∏≤‡∏á ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå ‡∏ö‡∏£‡∏≤‡∏ô‡∏ä‡πå‡∏Ñ‡∏£‡∏±‡∏ö...
    ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á git checkout -b feature/lab01-python...
    ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏£‡∏≤‡∏ô‡∏ä‡πå‡πÉ‡∏´‡∏°‡πà ‡πÅ‡∏•‡∏∞‡∏™‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ...
    ‡∏ó‡∏¥‡∏õ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç... ‡πÉ‡∏ô‡∏Å‡∏¥‡∏ï‡πÇ‡∏ü‡∏•‡∏ß‡πå‡∏ó‡∏µ‡πà‡∏î‡∏µ...
    ‡πÄ‡∏£‡∏≤‡∏Ñ‡∏ß‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå ‡∏ö‡∏£‡∏≤‡∏ô‡∏ä‡πå ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏™‡∏°‡∏≠...
    ‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£ ‡∏Ñ‡∏≠‡∏°‡∏°‡∏¥‡∏ï ‡∏ï‡∏£‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà ‡πÄ‡∏°‡∏ô ‡∏ö‡∏£‡∏≤‡∏ô‡∏ä‡πå ‡∏Ñ‡∏£‡∏±‡∏ö""",
    
    # Slide 7 - Task 5: Write Python OOP Example
    """‡∏ó‡∏≤‡∏™‡∏Ñ‡πå‡∏ó‡∏µ‡πà 5... ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î ‡πÑ‡∏û‡∏ò‡∏≠‡∏ô OOP ‡∏Ñ‡∏£‡∏±‡∏ö...
    ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà‡∏ä‡∏∑‡πà‡∏≠ lab01_example.py...
    ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô ‡∏Ñ‡∏•‡∏≤‡∏™ Document ‡∏ó‡∏µ‡πà‡∏°‡∏µ __init__ ‡∏£‡∏±‡∏ö title ‡πÅ‡∏•‡∏∞ content...
    ‡∏™‡∏£‡πâ‡∏≤‡∏á ‡πÄ‡∏°‡∏ò‡∏≠‡∏î get_summary ‡∏ó‡∏µ‡πà‡∏£‡∏µ‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô 100 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á content...
    ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏î‡∏™‡∏≠‡∏ö ‡∏™‡∏£‡πâ‡∏≤‡∏á ‡∏≠‡πá‡∏≠‡∏ö‡πÄ‡∏à‡∏Å‡∏ï‡πå ‡πÅ‡∏•‡∏∞ ‡∏û‡∏£‡∏¥‡∏ô‡∏ï‡πå ‡∏ã‡∏±‡∏°‡∏°‡∏≤‡∏£‡∏µ‡πà...
    ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô OOP ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏ï‡∏•‡∏≠‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡∏Ñ‡∏£‡∏±‡∏ö""",
    
    # Slide 8 - Task 6: Commit and Push
    """‡∏ó‡∏≤‡∏™‡∏Ñ‡πå‡∏ó‡∏µ‡πà 6... ‡∏Ñ‡∏≠‡∏°‡∏°‡∏¥‡∏ï ‡πÅ‡∏•‡∏∞ ‡∏û‡∏∏‡∏ä‡∏Ñ‡∏£‡∏±‡∏ö...
    ‡∏û‡∏¥‡∏°‡∏û‡πå git add . ‡πÄ‡∏û‡∏∑‡πà‡∏≠ ‡∏™‡πÄ‡∏ï‡∏à ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î...
    ‡πÅ‡∏•‡πâ‡∏ß git commit -m ‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏≥...
    ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢ git push origin feature/lab01-python...
    ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏Ç‡∏∂‡πâ‡∏ô ‡∏Å‡∏¥‡∏ï‡∏Æ‡∏±‡∏ö...
    ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô ‡∏Å‡∏¥‡∏ï‡∏Æ‡∏±‡∏ö ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö""",
    
    # Slide 9 - Task 7: Create Pull Request
    """‡∏ó‡∏≤‡∏™‡∏Ñ‡πå‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢... ‡∏™‡∏£‡πâ‡∏≤‡∏á ‡∏û‡∏π‡∏•‡∏£‡∏µ‡πÄ‡∏Ñ‡∏ß‡∏™‡∏ï‡πå‡∏Ñ‡∏£‡∏±‡∏ö...
    ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà ‡∏Å‡∏¥‡∏ï‡∏Æ‡∏±‡∏ö ‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå...
    ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏õ‡∏∏‡πà‡∏° Compare & pull request ‡πÉ‡∏´‡πâ‡∏Å‡∏î...
    ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î Create pull request...
    ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏° ‡∏ñ‡πà‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö""",
    
    # Slide 10 - Deliverables
    """‡∏°‡∏≤‡∏î‡∏π‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö...
    ‡∏´‡∏ô‡∏∂‡πà‡∏á... ‡∏ü‡∏≠‡∏£‡πå‡∏Ñ ‡∏£‡∏µ‡πÇ‡∏û‡∏ã‡∏¥‡∏ó‡∏≠‡∏£‡∏µ‡πà ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢...
    ‡∏™‡∏≠‡∏á... ‡∏™‡∏£‡πâ‡∏≤‡∏á ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå ‡∏ö‡∏£‡∏≤‡∏ô‡∏ä‡πå ‡πÅ‡∏•‡πâ‡∏ß...
    ‡∏™‡∏≤‡∏°... ‡∏Ñ‡∏≠‡∏°‡∏°‡∏¥‡∏ï ‡πÑ‡∏ü‡∏•‡πå ‡πÑ‡∏û‡∏ò‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß...
    ‡∏™‡∏µ‡πà... ‡∏™‡∏£‡πâ‡∏≤‡∏á ‡∏û‡∏π‡∏•‡∏£‡∏µ‡πÄ‡∏Ñ‡∏ß‡∏™‡∏ï‡πå ‡πÅ‡∏•‡πâ‡∏ß...
    ‡∏´‡πâ‡∏≤... ‡∏ñ‡πà‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ ‡∏û‡∏π‡∏•‡∏£‡∏µ‡πÄ‡∏Ñ‡∏ß‡∏™‡∏ï‡πå...
    ‡πÄ‡∏î‡∏î‡πÑ‡∏•‡∏ô‡πå ‡∏Ñ‡∏∑‡∏≠ ‡∏ß‡∏±‡∏ô‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå 23:59 ‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö...
    ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ‡∏Å‡∏±‡∏ö‡πÅ‡∏•‡πá‡∏ö‡πÅ‡∏£‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö!""",
]

# ============================================
# FUNCTIONS
# ============================================

async def generate_audio(text: str, output_file: str):
    communicate = edge_tts.Communicate(text, VOICE, rate=RATE)
    await communicate.save(output_file)

async def generate_all_audio():
    audio_dir = Path("audio")
    audio_dir.mkdir(exist_ok=True)
    
    print("üé§ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á AI...")
    for i, script in enumerate(SCRIPTS, 1):
        output_file = audio_dir / f"slide_{i:02d}.mp3"
        await generate_audio(script, str(output_file))
        print(f"  ‚úÖ Slide {i}/{len(SCRIPTS)}")
    print("‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå!\n")

def convert_pdf_to_images():
    images_dir = Path("images")
    images_dir.mkdir(exist_ok=True)
    
    print("üñºÔ∏è ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏õ‡∏•‡∏á PDF ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û...")
    images = convert_from_path(PDF_FILE, dpi=DPI)
    
    for i, image in enumerate(images, 1):
        output_file = images_dir / f"slide_{i:02d}.png"
        image.save(str(output_file), "PNG")
        print(f"  ‚úÖ Slide {i}/{len(images)}")
    
    print("‚úÖ ‡πÅ‡∏õ‡∏•‡∏á PDF ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå!\n")
    return len(images)

def create_video(num_slides: int):
    print("üé¨ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ß‡∏µ‡∏î‡∏µ‡πÇ‡∏≠...")
    clips = []
    total_duration = 0
    
    for i in range(1, num_slides + 1):
        image_file = f"images/slide_{i:02d}.png"
        audio_file = f"audio/slide_{i:02d}.mp3"
        
        if not Path(audio_file).exists():
            duration = 5
            clip = ImageClip(image_file).set_duration(duration)
        else:
            audio = AudioFileClip(audio_file)
            duration = audio.duration
            clip = ImageClip(image_file).set_duration(duration)
            clip = clip.set_audio(audio)
        
        clips.append(clip)
        total_duration += duration
        print(f"  ‚úÖ Slide {i}/{num_slides} ({duration:.1f}s)")
    
    print(f"\nüìä ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏£‡∏ß‡∏°: {total_duration/60:.1f} ‡∏ô‡∏≤‡∏ó‡∏µ")
    print("\nüìº ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏ß‡∏°‡∏ß‡∏µ‡∏î‡∏µ‡πÇ‡∏≠...")
    final_video = concatenate_videoclips(clips, method="compose")
    
    print("üíæ ‡∏Å‡∏≥‡∏•‡∏±‡∏á export ‡∏ß‡∏µ‡∏î‡∏µ‡πÇ‡∏≠...")
    final_video.write_videofile(
        OUTPUT_VIDEO, fps=24, codec="libx264", audio_codec="aac",
        threads=4, preset="medium", verbose=False, logger=None
    )
    
    final_video.close()
    for clip in clips:
        clip.close()
    
    print(f"\n‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ß‡∏µ‡∏î‡∏µ‡πÇ‡∏≠‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå: {OUTPUT_VIDEO}")

async def main():
    print("=" * 60)
    print("üé¨ Video Generator - Lab 01: Git + Python Fundamentals")
    print("=" * 60)
    print(f"üìÑ PDF: {PDF_FILE}")
    print(f"üé§ Voice: {VOICE}")
    print(f"üìπ Output: {OUTPUT_VIDEO}")
    print("=" * 60 + "\n")
    
    if not Path(PDF_FILE).exists():
        print(f"‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå PDF: {PDF_FILE}")
        return
    
    await generate_all_audio()
    num_slides = convert_pdf_to_images()
    create_video(min(num_slides, len(SCRIPTS)))
    
    print("\n" + "=" * 60)
    print("üéâ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!")
    print("=" * 60)

if __name__ == "__main__":
    asyncio.run(main())
