# Week 08: Docker Compose
# ========================
# นักศึกษาต้องทำตาม TODO ที่กำหนด

version: '3.8'

services:
  # ===========================================
  # TODO 1: API Service (15 คะแนน)
  # ===========================================
  # 
  # ต้องกำหนด:
  # - build: ./api
  # - container_name: rag-api
  # - ports: 9000:9000
  # - environment:
  #     - OPENSEARCH_HOST=opensearch
  #     - OPENSEARCH_PORT=9200
  # - depends_on: opensearch
  # - networks: rag-network
  # - restart: unless-stopped
  #
  # Hint:
  # api:
  #   build: ./api
  #   container_name: rag-api
  #   ports:
  #     - "9000:9000"
  #   environment:
  #     - OPENSEARCH_HOST=opensearch
  #     - OPENSEARCH_PORT=9200
  #   depends_on:
  #     - opensearch
  #   networks:
  #     - rag-network
  #   restart: unless-stopped
  #
  # เขียนโค้ดด้านล่างนี้:
  api:
    image: hello-world  # TODO: แก้เป็น build: ./api

  # ===========================================
  # TODO 2: Frontend Service (15 คะแนน)
  # ===========================================
  #
  # ต้องกำหนด:
  # - build: ./frontend
  # - container_name: rag-frontend
  # - ports: 8501:8501
  # - environment:
  #     - API_HOST=api
  #     - API_PORT=9000
  # - depends_on: api
  # - networks: rag-network
  # - restart: unless-stopped
  #
  # เขียนโค้ดด้านล่างนี้:
  frontend:
    image: hello-world  # TODO: แก้เป็น build: ./frontend

  # ===========================================
  # TODO 3: OpenSearch Service (10 คะแนน)
  # ===========================================
  #
  # ต้องกำหนด:
  # - image: opensearchproject/opensearch:2.11.1
  # - container_name: opensearch
  # - environment:
  #     - discovery.type=single-node
  #     - DISABLE_SECURITY_PLUGIN=true
  #     - OPENSEARCH_JAVA_OPTS=-Xms512m -Xmx512m
  # - ports: 9200:9200
  # - volumes: opensearch-data:/usr/share/opensearch/data
  # - networks: rag-network
  #
  # เขียนโค้ดด้านล่างนี้:
  opensearch:
    image: hello-world  # TODO: แก้เป็น opensearchproject/opensearch:2.11.1

# ===========================================
# TODO 4: Networks และ Volumes
# ===========================================
#
# Networks:
# - rag-network (driver: bridge)
#
# Volumes:
# - opensearch-data
#
# Hint:
# networks:
#   rag-network:
#     driver: bridge
#
# volumes:
#   opensearch-data:
#
# เขียนโค้ดด้านล่างนี้:

networks:
  rag-network:
    # TODO: กำหนด driver

volumes:
  opensearch-data:
    # TODO: volume configuration
